<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YiËØ≠Èü≥ËÆ°ÁÆó</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: #f1f1f1;
            font-family: Arial, sans-serif;
            transition: background 0.3s;
        }
        /* ËÆ°ÁÆóÂô®ÂÆπÂô® */
        #calculator {
            width: 300px;
            padding: 20px;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        /* ÂÖ®Â±èÁä∂ÊÄÅÊ†∑Âºè */
        body.fullscreen {
            background: #eaeaea;
        }
        body.fullscreen #calculator {
            width: 80vw;
            max-width: 600px;
            padding: 40px;
        }
        #display {
            width: 100%;
            height: 70px;
            padding: 15px;
            margin-bottom: 15px;
            text-align: right;
            font-size: 24px;
            border: 1px solid #eee;
            border-radius: 4px;
            outline: none;
            pointer-events: none;
        }
        body.fullscreen #display {
            height: 120px;
            font-size: 48px;
            margin-bottom: 25px;
        }
        .btn-row {
            display: flex;
            gap: 8px;
            margin-bottom: 8px;
        }
        button {
            flex: 1;
            height: 45px;
            font-size: 18px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            background: #f5f5f5;
            transition: background 0.2s;
        }
        body.fullscreen button {
            height: 80px;
            font-size: 32px;
        }
        button:hover {
            background: #e8e8e8;
        }
        #micBtn {
            background: #ff5252;
            color: #fff;
        }
        #micBtn:hover {
            background: #ff1744;
        }
        #clearBtn {
            background: #ff9800;
            color: #fff;
        }
        #equalBtn {
            background: #2196f3;
            color: #fff;
        }
        #fullscreenBtn {
            background: #4caf50;
            color: #fff;
        }
    </style>
</head>
<body>
    <div id="calculator">
        <input type="text" id="display" placeholder="0">
        <!-- Êñ∞Â¢ûÂÖ®Â±èÈîÆ -->
        <div class="btn-row">
            <button id="fullscreenBtn" onclick="toggleFullscreen()">‚õ∂ ÂÖ®Â±è</button>
            <button id="micBtn">üéôÔ∏è ËØ≠Èü≥</button>
            <button id="clearBtn" onclick="clearDisplay()">C Ê∏ÖÈõ∂</button>
        </div>
        <!-- ËøêÁÆóÈîÆË°å -->
        <div class="btn-row">
            <button onclick="appendToDisplay('/')">√∑</button>
            <button onclick="appendToDisplay('*')">√ó</button>
            <button onclick="appendToDisplay('-')">-</button>
            <button onclick="appendToDisplay('+')">+</button>
        </div>
        <!-- Êï∞Â≠óÈîÆË°å1 -->
        <div class="btn-row">
            <button onclick="appendToDisplay('7')">7</button>
            <button onclick="appendToDisplay('8')">8</button>
            <button onclick="appendToDisplay('9')">9</button>
            <button id="equalBtn" onclick="calculate()">=</button>
        </div>
        <!-- Êï∞Â≠óÈîÆË°å2 -->
        <div class="btn-row">
            <button onclick="appendToDisplay('4')">4</button>
            <button onclick="appendToDisplay('5')">5</button>
            <button onclick="appendToDisplay('6')">6</button>
            <button onclick="appendToDisplay('.')">.</button>
        </div>
        <!-- Êï∞Â≠óÈîÆË°å3 -->
        <div class="btn-row">
            <button onclick="appendToDisplay('1')">1</button>
            <button onclick="appendToDisplay('2')">2</button>
            <button onclick="appendToDisplay('3')">3</button>
            <button onclick="appendToDisplay('00')">00</button>
        </div>
        <!-- Êï∞Â≠óÈîÆË°å4 -->
        <div class="btn-row">
            <button onclick="appendToDisplay('0')">0</button>
        </div>
    </div>

    <script>
        const display = document.getElementById('display');
        const micBtn = document.getElementById('micBtn');
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        const SpeechSynthesis = window.speechSynthesis;
        const recognition = SpeechRecognition ? new SpeechRecognition() : null;
        const docEl = document.documentElement;

        // ÂÖ®Â±èÂàáÊç¢ÂáΩÊï∞
        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                docEl.requestFullscreen().catch(err => {
                    alert(`ÂÖ®Â±èÂàáÊç¢Â§±Ë¥•: ${err.message}`);
                });
                document.body.classList.add('fullscreen');
                document.getElementById('fullscreenBtn').textContent = "‚ùå ÈÄÄÂá∫ÂÖ®Â±è";
                speak('Â∑≤ËøõÂÖ•ÂÖ®Â±èÊ®°Âºè');
            } else {
                document.exitFullscreen();
                document.body.classList.remove('fullscreen');
                document.getElementById('fullscreenBtn').textContent = "‚õ∂ ÂÖ®Â±è";
                speak('Â∑≤ÈÄÄÂá∫ÂÖ®Â±èÊ®°Âºè');
            }
        }

        // ËØ≠Èü≥ËØÜÂà´ÂàùÂßãÂåñ
        if (recognition) {
            recognition.lang = 'zh-CN';
            recognition.interimResults = false;
            recognition.maxAlternatives = 1;

            micBtn.addEventListener('click', () => {
                try {
                    recognition.start();
                    micBtn.style.background = '#ff8a80';
                    speak('ËØ∑ËØ¥Âá∫ËÆ°ÁÆóÊåá‰ª§');
                } catch (e) {
                    alert('ËØ≠Èü≥ËØÜÂà´ÂêØÂä®Â§±Ë¥•ÔºåËØ∑Ê£ÄÊü•È∫¶ÂÖãÈ£éÊùÉÈôê');
                }
            });

            recognition.onresult = (event) => {
                const transcript = event.results[0][0].transcript.trim();
                const commandMap = {
                    'Èõ∂': '0', '‰∏Ä': '1', '‰∫å': '2', '‰∏â': '3', 'Âõõ': '4',
                    '‰∫î': '5', 'ÂÖ≠': '6', '‰∏É': '7', 'ÂÖ´': '8', '‰πù': '9',
                    'Âä†': '+', 'Âáè': '-', '‰πò': '*', 'Èô§': '/', 'Á≠â‰∫é': '=',
                    'ÁÇπ': '.', 'Ê∏ÖÈõ∂': 'C', 'ÂÖ®Â±è': 'ÂÖ®Â±è'
                };

                let input = '';
                for (let char of transcript) {
                    input += commandMap[char] || '';
                }

                if (input) {
                    if (input === 'C') {
                        clearDisplay();
                        speak('Â∑≤Ê∏ÖÈõ∂');
                    } else if (input === '=') {
                        calculate();
                    } else if (input === 'ÂÖ®Â±è') {
                        toggleFullscreen();
                    } else {
                        display.value += input;
                    }
                } else {
                    speak('Êú™ËØÜÂà´Âà∞ÊúâÊïàÊåá‰ª§ÔºåËØ∑ÈáçËØï');
                }
                micBtn.style.background = '#ff5252';
            };

            recognition.onend = () => {
                micBtn.style.background = '#ff5252';
            };
        } else {
            micBtn.disabled = true;
            micBtn.textContent = 'ËØ≠Èü≥‰∏çÊîØÊåÅ';
            alert('ÂΩìÂâçÊµèËßàÂô®‰∏çÊîØÊåÅËØ≠Èü≥ËØÜÂà´');
        }

        // ËØ≠Èü≥Êí≠Êä•
        function speak(text) {
            if (!SpeechSynthesis) return;
            SpeechSynthesis.cancel();
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'zh-CN';
            utterance.rate = 1;
            SpeechSynthesis.speak(utterance);
        }

        // ËøΩÂä†ÂÜÖÂÆπ
        function appendToDisplay(content) {
            display.value += content;
        }

        // Ê∏ÖÁ©∫ÊòæÁ§∫
        function clearDisplay() {
            display.value = '';
        }

        // ËÆ°ÁÆóÈÄªËæë
        function calculate() {
            try {
                const expression = display.value.replace('√ó', '*').replace('√∑', '/');
                const result = Function(`'use strict';return (${expression})`)();
                display.value = result;
                speak(`ËÆ°ÁÆóÁªìÊûúÊòØ${result}`);
            } catch (e) {
                display.value = 'ÈîôËØØ';
                speak('ËæìÂÖ•Ê†ºÂºèÈîôËØØÔºåËØ∑ÈáçÊñ∞ËæìÂÖ•');
                setTimeout(() => display.value = '', 2000);
            }
        }
    </script>
</body>
</html>