<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2024Yi2025电费对比</title>
    <style>
        * {margin: 0;padding: 0;box-sizing: border-box;font-family: Arial, sans-serif;}
        .container {max-width: 1000px;margin: 40px auto;padding: 0 20px;}
        /* 极简图表容器 */
        .chart-container {width: 100%;height: 400px;margin: 30px 0;}
        table {width: 100%;border-collapse: collapse;margin-top: 20px;}
        th, td {border: 1px solid #ddd;padding: 12px;text-align: center;}
        th {background-color: #f5f5f5;color: #555;font-weight: normal;}
        td {color: #333;}
        tr:nth-child(even) td {background-color: #fafafa;}
    </style>
    <!-- 引入Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="container">
        <!-- 可视化图表容器 -->
        <div class="chart-container">
            <canvas id="electricityChart"></canvas>
        </div>

        <!-- 原数据表格 -->
        <table id="electricityTable">
            <thead>
                <tr><th>月份</th><th>去年（元）</th><th>2025（¥）</th></tr>
            </thead>
            <tbody>
                <tr><td>1月</td><td>166.73</td><td>160.98</td></tr>
                <tr><td>2月</td><td>151.41</td><td>145.03</td></tr>
                <tr><td>3月</td><td>99.96</td><td>121.43</td></tr>
                <tr><td>4月</td><td>72.32</td><td>95.84</td></tr>
                <tr><td>5月</td><td>72.32</td><td>91.73</td></tr>
                <tr><td>6月</td><td>77.03</td><td>95.84</td></tr>
                <tr><td>7月</td><td>71.15</td><td>139.93</td></tr>
                <tr><td>8月</td><td>95.84</td><td>72.91</td></tr>
                <tr><td>9月</td><td>75.26</td><td>113.48</td></tr>
                <tr><td>10月</td><td>83.5</td><td>114.07</td></tr>
                <tr><td>11月</td><td>97.61</td><td>145.03</td></tr>
                <tr><td>12月</td><td>163.54</td><td>139.29</td></tr>
            </tbody>
            <tfoot>
                <tr><th>总计</th><th id="totalYear1">0.0</th><th id="totalYear2">0.0</th></tr>
            </tfoot>
        </table>
    </div>

    <script>
        // 计算总计
        function calculateTotals() {
            let total1 = 0, total2 = 0;
            const rows = document.querySelectorAll('#electricityTable tbody tr');
            rows.forEach(row => {
                const cell1 = parseFloat(row.cells[1].textContent) || 0;
                const cell2 = parseFloat(row.cells[2].textContent) || 0;
                total1 += cell1;
                total2 += cell2;
            });
            document.getElementById('totalYear1').textContent = total1.toFixed(1);
            document.getElementById('totalYear2').textContent = total2.toFixed(1);
            return {total1, total2, rows};
        }

        // 初始化图表
        function initChart() {
            const {rows} = calculateTotals();
            const months = [];
            const lastYear = [];
            const thisYear = [];

            // 提取表格数据
            rows.forEach(row => {
                months.push(row.cells[0].textContent);
                lastYear.push(parseFloat(row.cells[1].textContent));
                thisYear.push(parseFloat(row.cells[2].textContent));
            });

            // 创建图表
            const ctx = document.getElementById('electricityChart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: months,
                    datasets: [
                        {
                            label: '去年',
                            data: lastYear,
                            backgroundColor: '#e0e0e0',
                            borderColor: '#9e9e9e',
                            borderWidth: 1
                        },
                        {
                            label: '2025年',
                            data: thisYear,
                            backgroundColor: '#2196f3',
                            borderColor: '#1976d2',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                boxWidth: 12,
                                font: {size: 12}
                            }
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: '#f0f0f0'
                            },
                            ticks: {
                                callback: function(value) {
                                    return value + ' 元';
                                }
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });
        }

        // 页面加载后执行
        document.addEventListener('DOMContentLoaded', initChart);
    </script>
</body>
</html>